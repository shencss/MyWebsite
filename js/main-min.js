const nav=document.querySelector('.nav');const navList=document.querySelector('.nav-list');const blocks=document.getElementsByClassName('block');const cover=document.querySelector('.cover');const introduction=document.querySelector('.introduction');const skillList=document.querySelector('.skill-list');const percentages=document.getElementsByClassName('skill-percentage');const moreBtn=document.querySelector('.work-rest');const workList=document.querySelector('.work-list');const worksImgs=document.getElementsByClassName('work-img');const detailBtns=document.getElementsByClassName('detail-btn');const noteDetails=document.getElementsByClassName('note-details');const closeBtns=document.getElementsByClassName('close-btn');const notesImgs=document.getElementsByClassName('note-img');const colletcionsImgs=document.getElementsByClassName('collection-img');const blogList=document.querySelector('.collection-blog-list');const blogIntroductions=document.getElementsByClassName('blog-item-introduction');const mailBox=document.querySelector('.mail-box');const emailAddress=document.querySelector('.email-address');const githubAddress=document.querySelector('.github-address');let pageHeight=document.documentElement.scrollHeight||document.body.scrollHeight;const clientHeight=document.documentElement.clientHeight||document.body.clientHeight;const navHeight=nav.offsetHeight;let scrollHeightPre=0;let scrollHeightNow=document.documentElement.scrollTop||document.body.scrollTop;let selecetedNav=0;let hasReachBottom=false;const hasBlockInViewport=[false,false,false,false,false,false,false,false];let worksOnShow=6;function handleOnNavReact(){let showNav=true;scrollHeightPre=scrollHeightNow;scrollHeightNow=document.documentElement.scrollTop||document.body.scrollTop;if(scrollHeightNow>navHeight){if(scrollHeightNow>scrollHeightPre){showNav=false}}nav.style.height=showNav?'70px':'5px';for(let i=0,len=navList.children.length;i<len;i++){if(i<len-1){if(blocks[i].getBoundingClientRect().top<=clientHeight/2&&blocks[i+1].getBoundingClientRect().top>clientHeight/2){selecetedNav=i}}pageHeight=document.documentElement.scrollHeight||document.body.scrollHeight;if(scrollHeightNow+clientHeight==pageHeight){selecetedNav=len-1}if(i==selecetedNav){navList.children[i].classList.add('nav-selected')}else{navList.children[i].classList.remove('nav-selected')}}}navList.addEventListener('mouseover',()=>{navList.children[selecetedNav].classList.remove('nav-selected')});navList.addEventListener('mouseleave',()=>{navList.children[selecetedNav].classList.add('nav-selected')});for(let i=0,len=navList.children.length;i<len;i++){navList.children[i].addEventListener('click',()=>{let topToScroll=0;if(blocks[i].offsetHeight<clientHeight){topToScroll=blocks[i].offsetTop-(clientHeight-blocks[i].offsetHeight)/2-5}else{topToScroll=blocks[i].offsetTop-5}selecetedNav=i;window.scrollTo(0,topToScroll)})}function isElementTopInViewport(el){var rect=el.getBoundingClientRect();return rect.top<(window.innerHight||document.documentElement.clientHeight)}function isElementBottomInViewport(el){var rect=el.getBoundingClientRect();return rect.bottom<(window.innerHight||document.documentElement.clientHeight)}function lazyLoad(imgs){for(let i=0,len=imgs.length;i<len;i++){if(imgs[i].getAttribute('data-src')){imgs[i].src=imgs[i].getAttribute('data-src')}}}function handleOnBlockFadeIn(){if(hasReachBottom)return;if(isElementTopInViewport(introduction)){introduction.classList.add('fade-in')}for(let i=0,len=blocks.length;i<len-1;i++){if(!hasBlockInViewport[i]&&isElementTopInViewport(blocks[i])){blocks[i].classList.add('fade-in');if(i==4){lazyLoad(Array.prototype.slice.call(worksImgs,0,6))}if(i==5){lazyLoad(notesImgs)}if(i==6){lazyLoad(colletcionsImgs)}hasBlockInViewport[i]=true}}if(isElementBottomInViewport(skillList)){for(let j=0,len=percentages.length;j<len;j++){percentages[j].style.display='block'}}pageHeight=document.documentElement.scrollHeight||document.body.scrollHeight;if(!hasReachBottom&&(scrollHeightNow+clientHeight==pageHeight)){hasReachBottom=true;mailBox.style.display='block';emailAddress.style.animation='address-in .5s 1s ease-in-out both';githubAddress.style.animation='address-in .5s 1s ease-in-out both'}}moreBtn.addEventListener('click',()=>{if(worksOnShow+3<=workList.children.length){lazyLoad(Array.prototype.slice.call(worksImgs,worksOnShow,worksOnShow+3));for(let i=0;i<3;i++){workList.children[worksOnShow].style.display='block';worksOnShow++}if(worksOnShow==workList.children.length){moreBtn.style.display='none'}}});for(let i=0,len=detailBtns.length;i<len;i++){detailBtns[i].addEventListener('click',()=>{cover.style.display='block';noteDetails[i].style.display='block';noteDetails[i].style.animation='detail-fade-in .5s linear both';cover.addEventListener('click',()=>{noteDetails[i].style.display='none';cover.style.display='none'});closeBtns[i].addEventListener('click',()=>{noteDetails[i].style.display='none';cover.style.display='none'})})}for(let i=0,len=blogList.children.length;i<len;i++){let itemCount=0;blogList.children[i].addEventListener('mouseenter',()=>{itemCount=blogIntroductions[i].children[1].children.length;blogIntroductions[i].style.height=itemCount*20+10+'px'},false);blogList.children[i].addEventListener('mouseleave',()=>{blogIntroductions[i].style.height='0px'},false)}window.addEventListener('load',handleOnNavReact);window.addEventListener('scroll',handleOnNavReact);window.addEventListener('load',handleOnBlockFadeIn);window.addEventListener('scroll',handleOnBlockFadeIn);